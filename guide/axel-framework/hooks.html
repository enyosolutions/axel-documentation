<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>hooks | Axel Framework</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Documentation for the axel framework">
    <meta name="theme-color" content="orange">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/axel-documentation/assets/css/0.styles.cb9e4e50.css" as="style"><link rel="preload" href="/axel-documentation/assets/js/app.c20a55bc.js" as="script"><link rel="preload" href="/axel-documentation/assets/js/2.57c018d4.js" as="script"><link rel="preload" href="/axel-documentation/assets/js/17.4a846a0f.js" as="script"><link rel="prefetch" href="/axel-documentation/assets/js/10.7c5bd03e.js"><link rel="prefetch" href="/axel-documentation/assets/js/11.49d78e0e.js"><link rel="prefetch" href="/axel-documentation/assets/js/12.c8b3929b.js"><link rel="prefetch" href="/axel-documentation/assets/js/13.89754cf0.js"><link rel="prefetch" href="/axel-documentation/assets/js/14.304e195f.js"><link rel="prefetch" href="/axel-documentation/assets/js/15.7bed72ea.js"><link rel="prefetch" href="/axel-documentation/assets/js/16.8254ce1c.js"><link rel="prefetch" href="/axel-documentation/assets/js/18.4025971e.js"><link rel="prefetch" href="/axel-documentation/assets/js/19.ca6ac630.js"><link rel="prefetch" href="/axel-documentation/assets/js/20.41415564.js"><link rel="prefetch" href="/axel-documentation/assets/js/21.425d08b4.js"><link rel="prefetch" href="/axel-documentation/assets/js/22.46327716.js"><link rel="prefetch" href="/axel-documentation/assets/js/23.26028967.js"><link rel="prefetch" href="/axel-documentation/assets/js/24.abd8da94.js"><link rel="prefetch" href="/axel-documentation/assets/js/25.462bdd40.js"><link rel="prefetch" href="/axel-documentation/assets/js/26.3c8df07a.js"><link rel="prefetch" href="/axel-documentation/assets/js/3.c94d9973.js"><link rel="prefetch" href="/axel-documentation/assets/js/4.bf905f50.js"><link rel="prefetch" href="/axel-documentation/assets/js/5.633eca57.js"><link rel="prefetch" href="/axel-documentation/assets/js/6.77a98d9a.js"><link rel="prefetch" href="/axel-documentation/assets/js/7.40f51538.js"><link rel="prefetch" href="/axel-documentation/assets/js/8.f8c70aa1.js"><link rel="prefetch" href="/axel-documentation/assets/js/9.6103e93e.js">
    <link rel="stylesheet" href="/axel-documentation/assets/css/0.styles.cb9e4e50.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/axel-documentation/" class="home-link router-link-active"><img src="/axel-documentation/assets/img/rocket.svg" alt="Axel Framework" class="logo"> <span class="site-name can-hide">Axel Framework</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/axel-documentation/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="/axel-documentation/guide/axel-framework/" class="nav-link router-link-active">
  Config
</a></div><div class="nav-item"><a href="/axel-documentation/why/" class="nav-link">
  Why
</a></div><div class="nav-item"><a href="/axel-documentation/guide/axel-cli/" class="nav-link">
  Axel cli
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/axel-documentation/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="/axel-documentation/guide/axel-framework/" class="nav-link router-link-active">
  Config
</a></div><div class="nav-item"><a href="/axel-documentation/why/" class="nav-link">
  Why
</a></div><div class="nav-item"><a href="/axel-documentation/guide/axel-cli/" class="nav-link">
  Axel cli
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/axel-documentation/guide/" class="sidebar-heading clickable router-link-active open"><span>Guide</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/axel-documentation/guide/axel-cli/" class="sidebar-link">Axel cli</a></li><li><section class="sidebar-group is-sub-group depth-1"><a href="/axel-documentation/guide/axel-framework" class="sidebar-heading clickable router-link-active open"><span>Axel framework</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/axel-documentation/guide/axel-framework/" aria-current="page" class="sidebar-link">Intro</a></li><li><a href="/axel-documentation/guide/axel-framework/structure.html" class="sidebar-link">Directory structure</a></li><li><a href="/axel-documentation/guide/axel-framework/routing.html" class="sidebar-link">Routing</a></li><li><a href="/axel-documentation/guide/axel-framework/models.html" class="sidebar-link">Models</a></li><li><a href="/axel-documentation/guide/axel-framework/schema.html" class="sidebar-link">Schemas</a></li><li><a href="/axel-documentation/guide/axel-framework/hooks.html" aria-current="page" class="active sidebar-link">Hooks</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/axel-documentation/guide/axel-framework/hooks.html#api-hooks" class="sidebar-link">Api hooks</a></li><li class="sidebar-sub-header"><a href="/axel-documentation/guide/axel-framework/hooks.html#database-hooks" class="sidebar-link">Database hooks</a></li><li class="sidebar-sub-header"><a href="/axel-documentation/guide/axel-framework/hooks.html#executor-of-a-hook" class="sidebar-link">executor of a hook</a></li></ul></li><li><a href="/axel-documentation/guide/axel-framework/services.html" class="sidebar-link">Services</a></li><li><a href="/axel-documentation/guide/axel-framework/config-merging.html" class="sidebar-link">Config</a></li><li><a href="/axel-documentation/guide/axel-framework/framework-config.html" class="sidebar-link">Framework Config</a></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><a href="/axel-documentation/guide/axel-framework/help/" class="sidebar-heading clickable"><span>Trouble shooting</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="hooks"><a href="#hooks" class="header-anchor">#</a> hooks</h1> <p>Hooks are events that can be used to access or modify objects in the application before and after the creation of entities via the endpoints.
they are defined in the hooks folders. There are two kinds of hooks api and database hooks.</p> <h2 id="api-hooks"><a href="#api-hooks" class="header-anchor">#</a> Api hooks</h2> <p>Api hooks are executed at the controller level. They represent a macro level of access.</p> <p>The before hooks contain the following context :</p> <p><code>const context = {request : ExpressRequest, sequelizeQuery: SequelizeRequest }</code></p> <p>if you need to modify the body of a request you can do so by accessing the request object.</p> <p>Example</p> <div class="language- extra-class"><pre class="language-text"><code>// before creating an item affect the current user to request if it wasn't done before
module.exports.beforeApiCreate  = (context) =&gt; {
  if (context.request.body.createdBy &amp;&amp; context.request.user) {
    context.request.body.createdBy = context.request.user.id
  }
}
</code></pre></div><p>List of api hooks.</p> <div class="language- extra-class"><pre class="language-text"><code>// API middlewares
// context is an alias for context
// const {request : ExpressRequest, sequelizeQuery: SequelizeRequest } = context;
// api middlewares must return a promise or throw an error.
module.exports.beforeApiFind    = (context) =&gt; {}
module.exports.beforeApiFindOne = (context) =&gt; {}
module.exports.beforeApiCreate  = (context) =&gt; {}
module.exports.beforeApiUpdate  = (context) =&gt; {}
module.exports.beforeApiDelete  = (context) =&gt; {}

/**
* result the body of the response sent to the client
* context  = {request: Express Request, response: Express Response}
*/
module.exports.afterApiFind    = (result, context) =&gt; {}
module.exports.afterApiFindOne = (result, context) =&gt; {}
module.exports.afterApiCreate  = (result, context) =&gt; {}
module.exports.afterApiUpdate  = (result, context) =&gt; {}

</code></pre></div><h2 id="database-hooks"><a href="#database-hooks" class="header-anchor">#</a> Database hooks</h2> <p>Databade hooks are hooks that run on the ORM system. their name is tied to the underlying ORM.</p> <div class="language- extra-class"><pre class="language-text"><code>module.exports.beforeCreate = (&lt;%= identity %&gt;, options) =&gt; {}
module.exports.beforeDestroy = (&lt;%= identity %&gt;, options) =&gt; {}
module.exports.beforeUpdate = (&lt;%= identity %&gt;, options) =&gt; {}
module.exports.beforeSave = (&lt;%= identity %&gt;, options) =&gt; {}
module.exports.beforeUpsert = (values, options) =&gt; {}

module.exports.beforeBulkCreate = (&lt;%= identity %&gt;s, options) =&gt; {}
module.exports.beforeBulkDestroy = (options) =&gt; {}
module.exports.beforeBulkUpdate = (options) =&gt; {}

module.exports.beforeFind = (&lt;%= identity %&gt;s, options) =&gt; {}

// After
module.exports.afterCreate = (&lt;%= identity %&gt;, options) =&gt; {}
module.exports.afterDestroy = (&lt;%= identity %&gt;, options) =&gt; {}
module.exports.afterUpdate = (&lt;%= identity %&gt;, options) =&gt; {}
module.exports.afterSave = (&lt;%= identity %&gt;, options) =&gt; {}
module.exports.afterUpsert = (created, options) =&gt; {}

module.exports.afterBulkCreate = (&lt;%= identity %&gt;s, options) =&gt; {}
module.exports.afterBulkDestroy = (options) =&gt; {}
module.exports.afterBulkUpdate = (options) =&gt; {}

module.exports.afterFind = (&lt;%= identity %&gt;s, options) =&gt; {}
</code></pre></div><h2 id="executor-of-a-hook"><a href="#executor-of-a-hook" class="header-anchor">#</a> executor of a hook</h2> <div class="language- extra-class"><pre class="language-text"><code>module.exports.execHook = async (modelName, hookName, ...rest) =&gt; {
  if (has(axel, `models.${modelName}.hooks.${hookName}`)) {
    debug('executing hook', `models.${modelName}.hooks.${hookName}`);
    const func = get(axel, `models.${modelName}.hooks.${hookName}`);
    // execute promise
    const output = func(...rest);
    // if it's a promise then wait for it.
    if (output &amp;&amp; output.then) {
      await output;
      return null;
    }
    return Promise.resolve(null);
  }
};
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/axel-documentation/guide/axel-framework/schema.html" class="prev">
        Schemas
      </a></span> <span class="next"><a href="/axel-documentation/guide/axel-framework/services.html">
        Services
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/axel-documentation/assets/js/app.c20a55bc.js" defer></script><script src="/axel-documentation/assets/js/2.57c018d4.js" defer></script><script src="/axel-documentation/assets/js/17.4a846a0f.js" defer></script>
  </body>
</html>
