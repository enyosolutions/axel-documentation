(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{368:function(e,t,o){"use strict";o.r(t);var s=o(42),n=Object(s.a)({},(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[o("h1",{attrs:{id:"hooks"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#hooks"}},[e._v("#")]),e._v(" hooks")]),e._v(" "),o("p",[e._v("Hooks are events that can be used to access or modify objects in the application before and after the creation of entities via the endpoints.\nthey are defined in the hooks folders. There are two kinds of hooks api and database hooks.")]),e._v(" "),o("h2",{attrs:{id:"api-hooks"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#api-hooks"}},[e._v("#")]),e._v(" Api hooks")]),e._v(" "),o("p",[e._v("Api hooks are executed at the controller level. They represent a macro level of access.")]),e._v(" "),o("p",[e._v("The before hooks contain the following context :")]),e._v(" "),o("p",[o("code",[e._v("const context = {request : ExpressRequest, sequelizeQuery: SequelizeRequest }")])]),e._v(" "),o("p",[e._v("if you need to modify the body of a request you can do so by accessing the request object.")]),e._v(" "),o("p",[e._v("Example")]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("// before creating an item affect the current user to request if it wasn't done before\nmodule.exports.beforeApiCreate  = (context) => {\n  if (context.request.body.createdBy && context.request.user) {\n    context.request.body.createdBy = context.request.user.id\n  }\n}\n")])])]),o("p",[e._v("List of api hooks.")]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("// API middlewares\n// context is an alias for context\n// const {request : ExpressRequest, sequelizeQuery: SequelizeRequest } = context;\n// api middlewares must return a promise or throw an error.\nmodule.exports.beforeApiFind    = (context) => {}\nmodule.exports.beforeApiFindOne = (context) => {}\nmodule.exports.beforeApiCreate  = (context) => {}\nmodule.exports.beforeApiUpdate  = (context) => {}\nmodule.exports.beforeApiDelete  = (context) => {}\n\n/**\n* result the body of the response sent to the client\n* context  = {request: Express Request, response: Express Response}\n*/\nmodule.exports.afterApiFind    = (result, context) => {}\nmodule.exports.afterApiFindOne = (result, context) => {}\nmodule.exports.afterApiCreate  = (result, context) => {}\nmodule.exports.afterApiUpdate  = (result, context) => {}\n\n")])])]),o("h2",{attrs:{id:"database-hooks"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#database-hooks"}},[e._v("#")]),e._v(" Database hooks")]),e._v(" "),o("p",[e._v("Databade hooks are hooks that run on the ORM system. their name is tied to the underlying ORM.")]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("module.exports.beforeCreate = (<%= identity %>, options) => {}\nmodule.exports.beforeDestroy = (<%= identity %>, options) => {}\nmodule.exports.beforeUpdate = (<%= identity %>, options) => {}\nmodule.exports.beforeSave = (<%= identity %>, options) => {}\nmodule.exports.beforeUpsert = (values, options) => {}\n\nmodule.exports.beforeBulkCreate = (<%= identity %>s, options) => {}\nmodule.exports.beforeBulkDestroy = (options) => {}\nmodule.exports.beforeBulkUpdate = (options) => {}\n\nmodule.exports.beforeFind = (<%= identity %>s, options) => {}\n\n// After\nmodule.exports.afterCreate = (<%= identity %>, options) => {}\nmodule.exports.afterDestroy = (<%= identity %>, options) => {}\nmodule.exports.afterUpdate = (<%= identity %>, options) => {}\nmodule.exports.afterSave = (<%= identity %>, options) => {}\nmodule.exports.afterUpsert = (created, options) => {}\n\nmodule.exports.afterBulkCreate = (<%= identity %>s, options) => {}\nmodule.exports.afterBulkDestroy = (options) => {}\nmodule.exports.afterBulkUpdate = (options) => {}\n\nmodule.exports.afterFind = (<%= identity %>s, options) => {}\n")])])]),o("h2",{attrs:{id:"executor-of-a-hook"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#executor-of-a-hook"}},[e._v("#")]),e._v(" executor of a hook")]),e._v(" "),o("div",{staticClass:"language- extra-class"},[o("pre",{pre:!0,attrs:{class:"language-text"}},[o("code",[e._v("module.exports.execHook = async (modelName, hookName, ...rest) => {\n  if (has(axel, `models.${modelName}.hooks.${hookName}`)) {\n    debug('executing hook', `models.${modelName}.hooks.${hookName}`);\n    const func = get(axel, `models.${modelName}.hooks.${hookName}`);\n    // execute promise\n    const output = func(...rest);\n    // if it's a promise then wait for it.\n    if (output && output.then) {\n      await output;\n      return null;\n    }\n    return Promise.resolve(null);\n  }\n};\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);